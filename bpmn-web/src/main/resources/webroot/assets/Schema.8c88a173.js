import{c as D,r as a,o as _,a as E,b as i,w as n,d as C,t as M,u as k,e as j,f as A,g as z,h as g,i as U,s as B,j as Y,n as K,k as R,l as G,m as Z,F as H,p as S}from"./index.a5a61868.js";const O={type:"object",required:["$key","type"],"meta:ui:title":"\u5B57\u6BB5","meta:ui:description":"\u5B57\u6BB5","meta:ui:placeholder":"\u5B57\u6BB5",properties:{$key:{type:"string",minLength:1,pattern:"^[a-zA-Z]\\w{0,15}$","meta:ui:title":"\u5B57\u6BB5KEY","meta:ui:description":"\u5B57\u6BB5KEY","meta:ui:placeholder":"\u5B57\u6BB5KEY"},type:{$ref:"#/$defs/simpleTypes","meta:ui:title":"\u7C7B\u578B","meta:ui:description":"\u6570\u636E\u7C7B\u578B","meta:ui:placeholder":"\u8BF7\u9009\u62E9\u6570\u636E\u7C7B\u578B"},"meta:ui:title":{type:"string",minLength:1,"meta:ui:title":"\u5B57\u6BB5\u540D\u79F0","meta:ui:description":"\u5B57\u6BB5\u540D\u79F0","meta:ui:placeholder":"\u8BF7\u8F93\u5165\u5B57\u6BB5\u540D\u79F0"},"meta:ui:description":{type:"string","meta:ui:title":"\u5B57\u6BB5\u63CF\u8FF0","meta:ui:description":"\u5B57\u6BB5\u63CF\u8FF0","meta:ui:placeholder":"\u8BF7\u8F93\u5165\u5B57\u6BB5\u63CF\u8FF0"}},allOf:[{if:{type:"object",required:["type"],properties:{type:{const:"string"}}},then:{properties:{maxLength:{$ref:"#/$defs/nonNegativeInteger","meta:ui:title":"\u6700\u5927\u957F\u5EA6","meta:ui:description":"\u6700\u5927\u957F\u5EA6","meta:ui:placeholder":"\u8BF7\u8F93\u5165\u5141\u8BB8\u7684\u6700\u5927\u957F\u5EA6"},minLength:{$ref:"#/$defs/nonNegativeIntegerDefault0","meta:ui:title":"\u6700\u5C0F\u957F\u5EA6","meta:ui:description":"\u6700\u5C0F\u957F\u5EA6","meta:ui:placeholder":"\u8BF7\u8F93\u5165\u5141\u8BB8\u7684\u6700\u5C0F\u957F\u5EA6"},pattern:{type:"string","meta:ui:title":"\u6B63\u5219","meta:ui:description":"\u5B57\u7B26\u4E32\u6B63\u5219\u6821\u9A8C","meta:ui:placeholder":"\u8BF7\u8F93\u5165\u6B63\u5219\u8868\u8FBE\u5F0F"},format:{type:"string","meta:ui:title":"\u89C4\u5219","meta:ui:description":"\u5B57\u7B26\u4E32\u5185\u7F6E\u89C4\u5219\u6821\u9A8C","meta:ui:placeholder":"\u8BF7\u9009\u62E9\u89C4\u5219"},enum:{type:"array",uniqueItems:!0,items:{type:"string",minLength:1},"meta:ui:title":"\u5B57\u5178","meta:ui:description":"\u5B57\u7B26\u4E32\u53EF\u9009\u503C","meta:ui:placeholder":"\u8BF7\u9009\u62E9"},default:{type:"string","meta:ui:title":"\u9ED8\u8BA4\u503C","meta:ui:description":"\u9ED8\u8BA4\u503C","meta:ui:placeholder":"\u9ED8\u8BA4\u503C"}}}},{if:{type:"object",required:["type"],properties:{type:{const:"integer"}}},then:{properties:{maximum:{type:"integer",exclusiveMinimum:0,"meta:ui:title":"\u6700\u5927\u503C(\u5305\u542B)","meta:ui:description":"\u6700\u5927\u503C\uFF0C\u5305\u62EC\u8BE5\u503C(<=)","meta:ui:placeholder":"\u8BF7\u8F93\u5165\u6700\u5927\u503C"},minimum:{type:"integer","meta:ui:title":"\u6700\u5C0F\u503C(\u5305\u542B)","meta:ui:description":"\u6700\u5C0F\u503C\uFF0C\u5305\u62EC\u8BE5\u503C(>=)","meta:ui:placeholder":"\u8BF7\u8F93\u5165\u6700\u5C0F\u503C"},exclusiveMaximum:{type:"integer","meta:ui:title":"\u6700\u5927\u503C(\u4E0D\u5305\u542B)","meta:ui:description":"\u6700\u5927\u503C\uFF0C\u4E0D\u5305\u62EC\u8BE5\u503C(<)","meta:ui:placeholder":"\u8BF7\u8F93\u5165\u6700\u5927\u503C"},exclusiveMinimum:{type:"integer","meta:ui:title":"\u6700\u5C0F\u503C(\u4E0D\u5305\u542B)","meta:ui:description":"\u6700\u5C0F\u503C\uFF0C\u4E0D\u5305\u62EC\u8BE5\u503C(>=)","meta:ui:placeholder":"\u8BF7\u8F93\u5165\u6700\u5C0F\u503C"},multipleOf:{type:"integer",exclusiveMinimum:0,"meta:ui:title":"\u500D\u6570","meta:ui:description":"\u6570\u636E\u7C7B\u578B\u6821\u9A8C\u89C4\u5219\uFF0C\u6570\u503C\u5FC5\u987B\u4E3A\u8F93\u5165\u503C\u7684\u6574\u6570\u500D","meta:ui:placeholder":"\u8BF7\u8F93\u5165"},enum:{type:"array",uniqueItems:!0,items:{type:"integer"},"meta:ui:title":"\u5B57\u5178","meta:ui:description":"\u53EF\u9009\u503C","meta:ui:placeholder":"\u8BF7\u9009\u62E9"},default:{type:"integer","meta:ui:title":"\u9ED8\u8BA4\u503C","meta:ui:description":"\u9ED8\u8BA4\u503C","meta:ui:placeholder":"\u9ED8\u8BA4\u503C"}}}},{if:{type:"object",required:["type"],properties:{type:{const:"number"}}},then:{properties:{maximum:{type:"number",exclusiveMinimum:0,"meta:ui:title":"\u6700\u5927\u503C(\u5305\u542B)","meta:ui:description":"\u6700\u5927\u503C\uFF0C\u5305\u62EC\u8BE5\u503C(<=)","meta:ui:placeholder":"\u8BF7\u8F93\u5165\u6700\u5927\u503C"},minimum:{type:"number","meta:ui:title":"\u6700\u5C0F\u503C(\u5305\u542B)","meta:ui:description":"\u6700\u5C0F\u503C\uFF0C\u5305\u62EC\u8BE5\u503C(>=)","meta:ui:placeholder":"\u8BF7\u8F93\u5165\u6700\u5C0F\u503C"},exclusiveMaximum:{type:"number","meta:ui:title":"\u6700\u5927\u503C(\u4E0D\u5305\u542B)","meta:ui:description":"\u6700\u5927\u503C\uFF0C\u4E0D\u5305\u62EC\u8BE5\u503C(<)","meta:ui:placeholder":"\u8BF7\u8F93\u5165\u6700\u5927\u503C"},exclusiveMinimum:{type:"number","meta:ui:title":"\u6700\u5C0F\u503C(\u4E0D\u5305\u542B)","meta:ui:description":"\u6700\u5C0F\u503C\uFF0C\u4E0D\u5305\u62EC\u8BE5\u503C(>=)","meta:ui:placeholder":"\u8BF7\u8F93\u5165\u6700\u5C0F\u503C"},precision:{type:"integer",minimum:-1,"meta:ui:title":"\u5C0F\u6570\u4F4D\u6570","meta:ui:description":"\u5C0F\u6570\u4F4D\u6570","meta:ui:placeholder":"\u5C0F\u6570\u4F4D\u6570"},multipleOf:{type:"number",exclusiveMinimum:0,"meta:ui:title":"\u500D\u6570","meta:ui:description":"\u6570\u636E\u7C7B\u578B\u6821\u9A8C\u89C4\u5219\uFF0C\u6570\u503C\u5FC5\u987B\u4E3A\u8F93\u5165\u503C\u7684\u6574\u6570\u500D","meta:ui:placeholder":"\u8BF7\u8F93\u5165"},enum:{type:"array",uniqueItems:!0,items:{type:"number"},"meta:ui:title":"\u5B57\u5178","meta:ui:description":"\u53EF\u9009\u503C","meta:ui:placeholder":"\u8BF7\u9009\u62E9"},default:{type:"number","meta:ui:title":"\u9ED8\u8BA4\u503C","meta:ui:description":"\u9ED8\u8BA4\u503C","meta:ui:placeholder":"\u9ED8\u8BA4\u503C"}}}},{if:{type:"object",required:["type"],properties:{type:{const:"boolean"}}},then:{properties:{enum:{type:"array",uniqueItems:!0,items:{type:"boolean"},"meta:ui:title":"\u5B57\u5178","meta:ui:description":"\u53EF\u9009\u503C","meta:ui:placeholder":"\u8BF7\u9009\u62E9"},default:{type:"boolean","meta:ui:title":"\u9ED8\u8BA4\u503C","meta:ui:description":"\u9ED8\u8BA4\u503C","meta:ui:placeholder":"\u9ED8\u8BA4\u503C"}}}},{if:{type:"object",required:["type"],properties:{type:{const:"array"}}},then:{properties:{maxItems:{$ref:"#/$defs/nonNegativeInteger","meta:ui:title":"\u6700\u5927\u4E2A\u6570","meta:ui:description":"\u6700\u5927\u4E2A\u6570","meta:ui:placeholder":"\u8BF7\u8F93\u5165\u6700\u5927\u4E2A\u6570"},minItems:{$ref:"#/$defs/nonNegativeIntegerDefault0","meta:ui:title":"\u6700\u5C0F\u4E2A\u6570","meta:ui:description":"\u6700\u5C0F\u4E2A\u6570","meta:ui:placeholder":"\u8BF7\u8F93\u5165\u6700\u5C0F\u4E2A\u6570"}}}}],$defs:{nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{$ref:"#/$defs/nonNegativeInteger",default:0},simpleTypes:{type:"string",enum:["string","integer","number","boolean","object","array"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}}};const J={class:"tree-node-text"},Q={class:"tree-node-type"},W={props:{node:{type:Object,required:!0},data:{type:Object,required:!0},append:Function,remove:Function},setup(r){const w=r,d=D(()=>w.data),f=o=>{const t=o.type;return t?t==="array"?`ARRAY<${o.children.length===0?"?":f(o.children[0])}>`:t.toUpperCase():"?"},v=D(()=>{const o=d.value.type;return o==="object"?!0:o==="array"?d.value.children.length<1:!1}),p=D(()=>f(d.value));return(o,t)=>{const b=a("el-tooltip"),x=a("circle-plus"),u=a("el-icon"),$=a("el-button"),y=a("delete");return _(),E("span",{class:"tree-node-content",onDragstart:t[2]||(t[2]=(...h)=>o.dragStart&&o.dragStart(...h))},[i(b,{content:r.node.label,"show-after":300},{default:n(()=>[C("span",null,[C("span",J,M(r.data.$key),1),C("span",Q,M(k(p)),1)])]),_:1},8,["content"]),k(v)?(_(),j($,{key:0,onClick:t[0]||(t[0]=A(h=>r.append(r.data,r.node),["stop"])),circle:""},{default:n(()=>[i(u,{size:15},{default:n(()=>[i(x)]),_:1})]),_:1})):z("",!0),r.node.level!==1?(_(),j($,{key:1,onClick:t[1]||(t[1]=A(h=>r.remove(r.data,r.node),["stop"])),circle:""},{default:n(()=>[i(u,{size:15},{default:n(()=>[i(y)]),_:1})]),_:1})):z("",!0)],32)}}};const X={props:{schema:{type:Object,default:()=>({type:"object",notValid:!0,"meta:ui:title":"schema"})}},setup(r){const w=r,d={children:"children",label:"meta:ui:title",class:e=>({"not-valid":e.notValid})},f=e=>e==="object"||e==="array",v=D(()=>w.schema),p=g(v.value),o=U(O);let t=g(),b=g();const x=(e,l)=>{t.value=e,b.value=l,V(e)},u={},$=e=>{u[e.id]||(u[e.id]=(e.children||[]).reduce((c,N)=>Math.max(+N.id.substring(e.id.length+1),c),0)),u[e.id]++;const l=e.id+"-"+u[e.id],m={id:l,"meta:ui:title":"\u5B57\u6BB5"+l,notValid:!0,children:[]};e.children||(e.children=[]),e.children.push(m),V(e),s()},y=(e,l)=>{const m=l.parent,c=m.data.children||m.data,N=c.findIndex(q=>q.id===e.id);c.splice(N,1),t.value&&t.value.id===e.id&&(t.value=null),V(m.data),s()},h=g([B(p.value)]),T=e=>{K(()=>V(e)),s()},V=e=>{f(e.type)?e.children.length===0||e.type==="array"&&e.children.length>1?e.notValid=!0:e.notValid=!o(e):(e.children=[],e.notValid=!o(e))},s=()=>{console.log(R(h.value))},L=e=>e.level!==1,P=(e,l,m)=>{if(m==="inner"){const c=l.data.type;return c==="object"?!0:c==="array"?l.data.children.length<1:!1}return l.level!==1&&l.parent.data.type!=="array"};return(e,l)=>{const m=a("el-tree"),c=a("el-col"),N=a("schema-form"),q=a("el-row");return _(),j(q,null,{default:n(()=>[i(c,{span:12},{default:n(()=>[i(m,{class:"schema-tree",data:h.value,props:d,"expand-on-click-node":!1,"node-key":"id",onCurrentChange:x,"default-expand-all":"",draggable:"","allow-drag":L,"allow-drop":P},{default:n(({node:I,data:F})=>[i(W,{data:F,node:I,append:$,remove:y},null,8,["data","node"])]),_:1},8,["data"])]),_:1}),i(c,{span:12},{default:n(()=>[k(t)?(_(),j(N,{key:0,schema:k(O),modelValue:k(t),"onUpdate:modelValue":l[0]||(l[0]=I=>Y(t)?t.value=I:t=I),onChange:T},null,8,["schema","modelValue"])):z("",!0)]),_:1})]),_:1})}}};const ee={class:"dialog-header"},te=C("span",{style:{"margin-left":"10px"}},"Schema",-1),ie={class:"dialog-footer"},ne=S("Cancel"),ae=S("Confirm"),le=S("Detail"),re=S("Edit"),ue={setup(r){const w=new Array(100).fill({date:"2016-05-03",name:"Tom",address:"No. 189, Grove St, Los Angeles"}),d=g(100),f=g(1),v=g(!0),p=g(!1);return setTimeout(()=>{v.value=!1},800),(o,t)=>{const b=a("circle-plus"),x=a("el-icon"),u=a("el-button"),$=a("el-dialog"),y=a("el-table-column"),h=a("el-table"),T=a("el-pagination"),V=G("loading");return _(),E(H,null,[i($,{modelValue:p.value,"onUpdate:modelValue":t[2]||(t[2]=s=>p.value=s),fullscreen:""},{title:n(()=>[C("div",ee,[i(x,{color:"var(--el-color-success)"},{default:n(()=>[i(b)]),_:1}),te])]),footer:n(()=>[C("span",ie,[i(u,{onClick:t[0]||(t[0]=s=>p.value=!1)},{default:n(()=>[ne]),_:1}),i(u,{type:"primary",onClick:t[1]||(t[1]=s=>p.value=!1)},{default:n(()=>[ae]),_:1})])]),default:n(()=>[i(X)]),_:1},8,["modelValue"]),i(u,{icon:"Plus",circle:"",onClick:t[3]||(t[3]=s=>p.value=!0)}),Z((_(),j(h,{height:"calc(100% - 50px)",data:k(w),stripe:"",border:""},{default:n(()=>[i(y,{prop:"date",label:"Date",width:"180"}),i(y,{prop:"name",label:"Name",width:"180"}),i(y,{prop:"address",label:"Address"}),i(y,{fixed:"right",label:"Operations",width:"120"},{default:n(()=>[i(u,{type:"text",size:"small"},{default:n(()=>[le]),_:1}),i(u,{type:"text",size:"small"},{default:n(()=>[re]),_:1})]),_:1})]),_:1},8,["data"])),[[V,v.value]]),i(T,{background:"",currentPage:f.value,"onUpdate:currentPage":t[4]||(t[4]=s=>f.value=s),"page-size":d.value,"onUpdate:page-size":t[5]||(t[5]=s=>d.value=s),layout:"sizes, prev, pager, next","page-sizes":[20,30,50,100],total:1e3},null,8,["currentPage","page-size"])],64)}}};export{ue as default};
